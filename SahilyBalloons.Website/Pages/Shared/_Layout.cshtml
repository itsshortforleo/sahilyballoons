<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"]</title>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/SahilyBalloons.Website.styles.css" asp-append-version="true" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@300&display=swap" rel="stylesheet">

    <!-- Favicon links -->
    <link rel="apple-touch-icon" sizes="180x180" href="~/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="~/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="~/favicon-16x16.png">
    <link rel="manifest" href="~/site.webmanifest">
    <link rel="mask-icon" href="~/safari-pinned-tab.svg" color="#5bbad5">
    <link rel="shortcut icon" href="~/favicon.ico">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="~/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=AW-11477406563"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'AW-11477406563');
    </script>

    <!-- AFTER your existing Global site tag (gtag.js) -->
    <!-- Event snippet for Click to call conversion -->
    <script>
        function gtag_report_conversion(url) {
          var callback = function () {
            if (typeof(url) != 'undefined') {
              window.location = url;
            }
          };
          gtag('event', 'conversion', {
              'send_to': 'AW-11477406563/UvBnCKzClsEbEOOm7eAq',
              'value': 1.0,
              'currency': 'USD',
              'event_callback': callback
          });
          return false;
        }
    </script>

    <!-- Microsoft Advertising UET tag for Sahily Balloons (ID: 97214979) -->
    <script>
        (function(w,d,t,r,u){
            var f,n,i;
            w[u]=w[u]||[];
            f=function(){
                var o={ti:"97214979", enableAutoSpaTracking: true};
                o.q=w[u];
                w[u]=new UET(o);
                w[u].push("pageLoad");
            };
            n=d.createElement(t);
            n.src=r;
            n.async=1;
            n.onload=n.onreadystatechange=function(){
                var s=this.readyState;
                if(!s || s==="loaded" || s==="complete"){
                    f();
                    n.onload=n.onreadystatechange=null;
                }
            };
            i=d.getElementsByTagName(t)[0];
            i.parentNode.insertBefore(n,i);
        })(window,document,"script","//bat.bing.com/bat.js","uetq");
    </script>
    <!-- End Microsoft Advertising UET tag -->

</head>
<body>
    <header>
        <nav class="navbar navbar-expand-sm navbar-toggleable-sm navbar-light bg-white border-bottom box-shadow mb-3">
            <div class="container">
@*                
                <minimo id="logo">
                    <a class="minimo" href="https://sahilyballoons.com/">sahily balloons</a> 
                </minimo>     *@
                <h1 id="logo">
                    <a href="https://sahilyballoons.com/">
                        <span>Sahily Balloons</span>
                    </a>
                </h1>                
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target=".navbar-collapse" aria-controls="navbarSupportedContent"
                        aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <div class="navbar-collapse collapse d-sm-inline-flex justify-content-between">
                    <ul class="navbar-nav flex-grow-1">
                        <li class="nav-item links">
                            <a class="nav-link text-dark" asp-area="" asp-page=""></a>
                        </li>
                        <li class="nav-item links">
                            <a class="nav-link text-dark" asp-area="" asp-page="/Index">Home</a>
                        </li>
@*                         <li class="nav-item links">
                            <a class="nav-link text-dark" asp-area="" asp-page="/News">News</a>
                        </li>
                        <li class="nav-item links">
                            <a class="nav-link text-dark" asp-area="" asp-page="/Donate">Donate</a>
                        </li>    *@                     
                        <li class="nav-item links">
                            <a class="nav-link text-dark" asp-area="" asp-page="/Contact">Contact</a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>
    <div class="container">
        <main role="main" class="pb-3">
            @RenderBody()
        </main>
    </div>

    <footer class="border-top footer text-muted">
        <div class="container">
            &copy; 2025 Sahily Balloons · a trade name of Sahily, LLC · 737 Silo St, Folsom, CA 95630 ·
            <a asp-area="" asp-page="/Privacy">Privacy</a>
        </div>
    </footer>

    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>

    <script>
        (function(){
          'use strict';

          // === Configuration ===
          var INSTAGRAM_HANDLE = 'sahilyballoons';      // the Instagram handle as it appears in the URL
          var EVENT_NAME = 'instagram_click';           // event name used in Google & Microsoft audiences
          var GOOGLE_EVENT_CATEGORY = 'outbound';       // Google event category
          var GOOGLE_EVENT_LABEL = 'instagram';         // Google event label
          var DELAY_MS = 200;                           // pause before same-tab navigation (ms)

          // === Helper: detect whether a link points to the Instagram handle ===
          function isInstagramHandleLink(href){
            if(!href) return false;
            try{
              // construct URL relative to current location
              var url = new URL(href, location.href);
              var host = (url.hostname || '').toLowerCase();
              var path = (url.pathname || '').toLowerCase();
              // require instagram host
              if(host.indexOf('instagram.com') === -1) return false;
              // require path contains the handle (e.g. /sahilyballoons or /sahilyballoons/)
              return path.indexOf('/' + INSTAGRAM_HANDLE.toLowerCase()) !== -1;
            }catch(e){
              return false;
            }
          }

          // === Send Google Analytics / Google Ads event via gtag ===
          function sendGoogleEvent(){
            if(typeof window.gtag === 'function'){
              try{
                gtag('event', EVENT_NAME, {
                  'event_category': GOOGLE_EVENT_CATEGORY,
                  'event_label': GOOGLE_EVENT_LABEL,
                  'transport_type': 'beacon'
                });
              }catch(e){
                // swallow errors to avoid breaking navigation
              }
            }
          }

          // === Send Microsoft UET custom event ===
          function sendUetEvent(){
            try{
              window.uetq = window.uetq || [];
              window.uetq.push('event', EVENT_NAME, { 'category': 'outbound' });
            }catch(e){
              // ignore failures
            }
          }

          // === Click handler attached to each Instagram link ===
          function onInstagramClick(e){
            var el = e.currentTarget;

            // detect new-tab open (ctrl/cmd/middle-click/explicit target=_blank)
            var openInNewTab = el.target === '_blank' || e.ctrlKey || e.metaKey || e.shiftKey || e.button === 1;

            // fire both analytics events
            sendGoogleEvent();
            sendUetEvent();

            // for same-tab clicks, delay navigation slightly so beacon requests can be sent
            if(!openInNewTab){
              e.preventDefault();
              var href = el.href;
              setTimeout(function(){
                window.location.assign(href);
              }, DELAY_MS);
            }
            // for new-tab opens do nothing — browser handles navigation
          }

          // === Attach handler to a single anchor if it points to the IG handle ===
          function attachToAnchor(a){
            if(!a) return;
            try{
              // mark the element so we don't attach twice
              if(a.getAttribute('data-ig-tracked') === '1') return;
              a.setAttribute('data-ig-tracked', '1');
            }catch(e){
              // ignore DOM errors
            }
            var href = a.getAttribute('href');
            if(!isInstagramHandleLink(href)) return;
            a.addEventListener('click', onInstagramClick, { passive: false });
          }

          // === Scan all anchors currently on the page and attach handlers ===
          function scanAnchors(){
            var anchors = document.querySelectorAll('a[href]');
            for(var i=0;i<anchors.length;i++){
              attachToAnchor(anchors[i]);
            }
          }

          // === Observe the DOM for anchors added later (handles dynamic content) ===
          function observeMutations(){
            if(!window.MutationObserver) return;
            var observer = new MutationObserver(function(mutations){
              mutations.forEach(function(m){
                if(m.addedNodes && m.addedNodes.length){
                  for(var i=0;i<m.addedNodes.length;i++){
                    var node = m.addedNodes[i];
                    if(node.nodeType !== 1) continue;
                    if(node.tagName === 'A') attachToAnchor(node);
                    else {
                      var found = node.querySelectorAll && node.querySelectorAll('a[href]');
                      if(found && found.length){
                        for(var j=0;j<found.length;j++) attachToAnchor(found[j]);
                      }
                    }
                  }
                }
              });
            });
            observer.observe(document.documentElement || document.body, { childList: true, subtree: true });
          }

          // === Initialize on DOM ready ===
          if(document.readyState === 'loading'){
            document.addEventListener('DOMContentLoaded', function(){ scanAnchors(); observeMutations(); });
          } else {
            scanAnchors(); observeMutations();
          }

        })();
    </script>

    @await RenderSectionAsync("Scripts", required: false)

    <!-- Simple cookie / privacy banner -->
    <div id="sb-cookie-banner" style="
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  padding: 12px 16px;
  background: rgba(0,0,0,0.85);
  color: #fff;
  font-size: 14px;
  display: none;
  z-index: 9999;
">
        <div style="max-width: 960px; margin: 0 auto; display: flex; align-items: center; gap: 12px; flex-wrap: wrap;">
            <span style="flex: 1 1 auto;">
                We use cookies for analytics and advertising. By using this site, you agree to our
                <a href="/Privacy" style="color: #66c2ff; text-decoration: underline;">Privacy Policy</a>.
            </span>
            <button id="sb-cookie-banner-btn" style="
      flex: 0 0 auto;
      padding: 6px 14px;
      border: none;
      border-radius: 4px;
      background: #ffffff;
      color: #000000;
      cursor: pointer;
      font-weight: 600;
    ">
                Got it
            </button>
        </div>
    </div>

    <script>
        (function() {
          var storageKey = 'sb_cookie_banner_dismissed';
          if (localStorage.getItem(storageKey) === '1') return;

          var banner = document.getElementById('sb-cookie-banner');
          var btn = document.getElementById('sb-cookie-banner-btn');
          if (!banner || !btn) return;

          banner.style.display = 'block';

          btn.addEventListener('click', function() {
            banner.style.display = 'none';
            localStorage.setItem(storageKey, '1');
          });
        })();
    </script>
    <!-- End cookie / privacy banner -->

</body>
</html>